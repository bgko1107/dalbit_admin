<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dalbit.member.dao.M_BroadcastDao" >


    <select id="getBroadList" resultType="com.dalbit.member.vo.BroadListVo">
        /* M_Broadcast.xml - getBroadList */
        SELECT
          b.subject_type
          , b.title
          , b.start_date
          , b.end_date
          , b.airtime
          , m.listener
          , m.good
          , m.gold
        FROM tb_broadcast_room b
          , tb_member_broadcast_broadcasting m
        WHERE b.room_no = m.room_no
    </select>

    <select id="getBroadHistory_detail" parameterType="com.dalbit.member.vo.BroadListVo" resultType="com.dalbit.member.vo.BroadListVo">
        /* M_Broadcast.xml - getBroadList */
        SELECT
           (SELECT aa.code From tbl_code_define aa WHERE aa.type='subject_type' and aa.value = lpad(b.subject_type,2,'0')) as subject_type
            , b.title as title
            , DATE_FORMAT(b.start_date,'%Y-%m-%d %H:%i:%s') as start_date
            , DATE_FORMAT(b.end_date,'%Y-%m-%d %H:%i:%s') as end_date
            , b.airtime as  airtime
            , m.listener as listener
            , m.good
            , m.gold
        FROM tb_broadcast_room b, tb_member_broadcast_broadcasting m
       WHERE b.room_no = m.room_no
         AND b.mem_no = #{memNo}
    </select>


</mapper>