<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dalbit.broadcast.dao.B_ListenerDao" >

    <select id="callListener_detail" parameterType="com.dalbit.broadcast.vo.ListenerVo" resultType="com.dalbit.broadcast.vo.ListenerVo">
        /* B_Listener.xml - callListener_detail */
        select a.mem_no as memNo
              , b.mem_id as memId
              , b.mem_nick as memNick
              , DATE_FORMAT(a.start_date, '%Y-%m-%d %H:%i:%s')                    as listenStDate
              , DATE_FORMAT(a.end_date, '%Y-%m-%d %H:%i:%s')                      as listenEdDate
              , TIME_FORMAT(SEC_TO_TIME(a.listentime), '%H시간 %i분 %s초')  as listenTime
              , gift_ruby as giftRuby
         From rd_data.tb_member_broadcast_listening a left join ( select mem_no, mem_id, mem_nick from rd_data.tb_member_basic) b
           on a.mem_no = b.mem_no
        where room_no=#{roomNo}
        order by listenStDate desc;
    </select>
</mapper>